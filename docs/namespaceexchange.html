<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AES-DH Implementation: exchange Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AES-DH Implementation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">exchange Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The namespace for Key-Exchange functions.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab37416384dcd834529cb06395e8ab9f2" id="r_ab37416384dcd834529cb06395e8ab9f2"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab37416384dcd834529cb06395e8ab9f2">compute_intermediary</a> (const uint64_t &amp;p, const uint64_t &amp;g, const uint64_t &amp;k)</td></tr>
<tr class="memdesc:ab37416384dcd834529cb06395e8ab9f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the intermeidary value to send across the wire.  <br /></td></tr>
<tr class="separator:ab37416384dcd834529cb06395e8ab9f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a511ddac1db9f3e26b094bc0b765c0f65" id="r_a511ddac1db9f3e26b094bc0b765c0f65"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a511ddac1db9f3e26b094bc0b765c0f65">exchange_keys</a> (const bool &amp;server)</td></tr>
<tr class="memdesc:a511ddac1db9f3e26b094bc0b765c0f65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exchange keys on an established connection.  <br /></td></tr>
<tr class="separator:a511ddac1db9f3e26b094bc0b765c0f65"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The namespace for Key-Exchange functions. </p>
<dl class="section remark"><dt>Remarks</dt><dd>This code has been created with reference to: <a href="https://datatracker.ietf.org/doc/html/rfc2631#section-2.1">https://datatracker.ietf.org/doc/html/rfc2631#section-2.1</a> Herein referred to as "The Reference" </dd>
<dd>
The Diffie-Hellman Key Exchange Algorithm is a means for two peers to negotiate a secure, shared key in an untrusted network. Each peer will generate a private key a, and b. They will then used A shared, public key containing a large prime number p, and a primitive root of p: g. Each party will take g, and raise it to their private key, sending it to the other party. Then, they will take their other peer's intermediary key, and raise it by their own private key. This leads to the following values (g^a)^b, (g^b)^b, which when Simplied leads to g^(ab), g^(ba), which due to the associative property of multiplication will lead to the same, shared key. Every operation in this exchange is done with mod p. Due to the difficulty in computing discrete logarithms, while computing the intermediary and shared key is easy if a private key is known (Simply raising a value), it is infesible For an attacker to try and determine the private key used to create an intermediary given only the intermediary value and the public p,g. This makes Diffie-Hellman a one-way function. </dd>
<dd>
In this implementation, The server will generate the public p and g, and will send them alongside the intermediary to the other party. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab37416384dcd834529cb06395e8ab9f2" name="ab37416384dcd834529cb06395e8ab9f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab37416384dcd834529cb06395e8ab9f2">&#9670;&#160;</a></span>compute_intermediary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t exchange::compute_intermediary </td>
          <td>(</td>
          <td class="paramtype">const uint64_t &amp;</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t &amp;</td>          <td class="paramname"><span class="paramname"><em>g</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t &amp;</td>          <td class="paramname"><span class="paramname"><em>k</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the intermeidary value to send across the wire. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The prime. </td></tr>
    <tr><td class="paramname">g</td><td>The g. </td></tr>
    <tr><td class="paramname">k</td><td>The private key. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The g**k % p via a reduced g**r % p </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function uses the reduced calculation by generating q,r. <a class="el" href="namespaceprime.html#afd42038a213dacfa2cf643b7fd78a180" title="A O(logn) raise operation that works within modulus to prevent overflow.">prime::raise</a> is leagues fast enough to just do the computation directly, but if working with very large numbers, this would make a substantial difference on performance. </dd></dl>

</div>
</div>
<a id="a511ddac1db9f3e26b094bc0b765c0f65" name="a511ddac1db9f3e26b094bc0b765c0f65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a511ddac1db9f3e26b094bc0b765c0f65">&#9670;&#160;</a></span>exchange_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t exchange::exchange_keys </td>
          <td>(</td>
          <td class="paramtype">const bool &amp;</td>          <td class="paramname"><span class="paramname"><em>server</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Exchange keys on an established connection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">server</td><td>Whether this is the server. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The shared key to be used for communication </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>See 2.1.1 of the Reference. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
