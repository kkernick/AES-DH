<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AES-DH Implementation: prime Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AES-DH Implementation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">prime Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The namespace for prime number related operations.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a46236c1d23c9711231e97132407d33af" id="r_a46236c1d23c9711231e97132407d33af"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a46236c1d23c9711231e97132407d33af">is</a> (const uint64_t &amp;num)</td></tr>
<tr class="memdesc:a46236c1d23c9711231e97132407d33af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if any given number is prime.  <br /></td></tr>
<tr class="separator:a46236c1d23c9711231e97132407d33af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c8557a10c21117dd64b2ad1f88370de" id="r_a7c8557a10c21117dd64b2ad1f88370de"><td class="memTemplParams" colspan="2">template&lt;typename T  = uint64_t&gt; </td></tr>
<tr class="memitem:a7c8557a10c21117dd64b2ad1f88370de"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a7c8557a10c21117dd64b2ad1f88370de">next</a> (T &amp;num)</td></tr>
<tr class="memdesc:a7c8557a10c21117dd64b2ad1f88370de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the next prime greater than the provided number.  <br /></td></tr>
<tr class="separator:a7c8557a10c21117dd64b2ad1f88370de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd42038a213dacfa2cf643b7fd78a180" id="r_afd42038a213dacfa2cf643b7fd78a180"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afd42038a213dacfa2cf643b7fd78a180">raise</a> (uint64_t value, uint64_t exp, const uint64_t &amp;mod)</td></tr>
<tr class="memdesc:afd42038a213dacfa2cf643b7fd78a180"><td class="mdescLeft">&#160;</td><td class="mdescRight">A O(logn) raise operation that works within modulus to prevent overflow.  <br /></td></tr>
<tr class="separator:afd42038a213dacfa2cf643b7fd78a180"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55b24169031fb8a19e7f1bc724a63fda" id="r_a55b24169031fb8a19e7f1bc724a63fda"><td class="memItemLeft" align="right" valign="top">std::pair&lt; uint64_t, uint64_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a55b24169031fb8a19e7f1bc724a63fda">generate</a> ()</td></tr>
<tr class="memdesc:a55b24169031fb8a19e7f1bc724a63fda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a prime number.  <br /></td></tr>
<tr class="separator:a55b24169031fb8a19e7f1bc724a63fda"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The namespace for prime number related operations. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Everything is inlined; this will increase binary size, but hopefully (If the compiler wants to cooperate) increase speed. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>values are stored in regular C++ datatypes; best practice would be to use secure classes, such as a container that allocates on the heap, and then overwrites the values randomly upon its destruction. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a55b24169031fb8a19e7f1bc724a63fda" name="a55b24169031fb8a19e7f1bc724a63fda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55b24169031fb8a19e7f1bc724a63fda">&#9670;&#160;</a></span>generate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; uint64_t, uint64_t &gt; prime::generate </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generates a prime number. </p>
<dl class="section return"><dt>Returns</dt><dd>A prime number p, and the smaller prime q. </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function will use std::rand() to find a starting value, and then find the nearest prime larger than it. There are some cavets to this approach for the sake of simplicity and readibility. Firstly, primes are confined from 3 - 2**64 Secondly, std::rand() is not considered a cryptographically secure PRNG. However, this implemention makes it easier to understand, and allows us to work within the confines of standard integer types. </dd>
<dd>
See 2.2 of the Diffie-Hellman Reference. </dd></dl>

</div>
</div>
<a id="a46236c1d23c9711231e97132407d33af" name="a46236c1d23c9711231e97132407d33af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46236c1d23c9711231e97132407d33af">&#9670;&#160;</a></span>is()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool prime::is </td>
          <td>(</td>
          <td class="paramtype">const uint64_t &amp;</td>          <td class="paramname"><span class="paramname"><em>num</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if any given number is prime. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num</td><td>The number. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the number is prime, False if it isn't. </dd></dl>

</div>
</div>
<a id="a7c8557a10c21117dd64b2ad1f88370de" name="a7c8557a10c21117dd64b2ad1f88370de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c8557a10c21117dd64b2ad1f88370de">&#9670;&#160;</a></span>next()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = uint64_t&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void prime::next </td>
          <td>(</td>
          <td class="paramtype">T &amp;</td>          <td class="paramname"><span class="paramname"><em>num</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find the next prime greater than the provided number. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>The type of number. Generating a prime uses half-width. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num</td><td>The number (Does not need to be prime itself) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is intended to overflow, since the datatype is unsigned. Since we are always dealing with odd numbers, an overflow will bring us to 1. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This function is done in-place. It modifies the number you pass to it. </dd></dl>

</div>
</div>
<a id="afd42038a213dacfa2cf643b7fd78a180" name="afd42038a213dacfa2cf643b7fd78a180"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd42038a213dacfa2cf643b7fd78a180">&#9670;&#160;</a></span>raise()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t prime::raise </td>
          <td>(</td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>value</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>exp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t &amp;</td>          <td class="paramname"><span class="paramname"><em>mod</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A O(logn) raise operation that works within modulus to prevent overflow. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>The value to raise. </td></tr>
    <tr><td class="paramname">exp</td><td>The exponent to raise the value by. </td></tr>
    <tr><td class="paramname">mod</td><td>The mod space </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the result. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>From <a href="https://www.geeksforgeeks.org/primitive-root-of-a-prime-number-n-modulo-n/">https://www.geeksforgeeks.org/primitive-root-of-a-prime-number-n-modulo-n/</a> </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>Because raising values is almost assured to overflow when using such large numbers. We need to compute it piecemeal, applying the modulus on each self multiplication such that it remains bounded with our datatype. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
