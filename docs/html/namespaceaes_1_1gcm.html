<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AES-DH Implementation: aes::gcm Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AES-DH Implementation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceaes.html">aes</a></li><li class="navelem"><a class="el" href="namespaceaes_1_1gcm.html">gcm</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">aes::gcm Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Functions related to AES-GCM.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad32f2adca6691ec845600d8fa98c5bc3" id="r_ad32f2adca6691ec845600d8fa98c5bc3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad32f2adca6691ec845600d8fa98c5bc3">increment</a> (<a class="el" href="classaes_1_1state__array.html">state_array</a> &amp;X)</td></tr>
<tr class="memdesc:ad32f2adca6691ec845600d8fa98c5bc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Nonce Increment Function.  <br /></td></tr>
<tr class="separator:ad32f2adca6691ec845600d8fa98c5bc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab95f2c83cf8f0c6a3a9bb4565d561a30" id="r_ab95f2c83cf8f0c6a3a9bb4565d561a30"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classaes_1_1state__array.html">state_array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab95f2c83cf8f0c6a3a9bb4565d561a30">mult</a> (const <a class="el" href="classaes_1_1state__array.html">state_array</a> &amp;X, const <a class="el" href="classaes_1_1state__array.html">state_array</a> &amp;Y)</td></tr>
<tr class="memdesc:ab95f2c83cf8f0c6a3a9bb4565d561a30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a multiplication on two blocks of data.  <br /></td></tr>
<tr class="separator:ab95f2c83cf8f0c6a3a9bb4565d561a30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef9e152fad1ad6c97e90db2364ad5886" id="r_aef9e152fad1ad6c97e90db2364ad5886"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classaes_1_1state__array.html">state_array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aef9e152fad1ad6c97e90db2364ad5886">GHASH</a> (const <a class="el" href="classaes_1_1state.html">state</a> &amp;X, const <a class="el" href="classaes_1_1state__array.html">state_array</a> &amp;H)</td></tr>
<tr class="memdesc:aef9e152fad1ad6c97e90db2364ad5886"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the GHASH for a state.  <br /></td></tr>
<tr class="separator:aef9e152fad1ad6c97e90db2364ad5886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dbcc886156cfc4f185cf64e9d43615d" id="r_a3dbcc886156cfc4f185cf64e9d43615d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classaes_1_1state.html">state</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3dbcc886156cfc4f185cf64e9d43615d">GCTR</a> (<a class="el" href="classaes_1_1state.html">state</a> s, <a class="el" href="classaes_1_1state__array.html">state_array</a> ICB)</td></tr>
<tr class="memdesc:a3dbcc886156cfc4f185cf64e9d43615d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply AES-CTR to a message.  <br /></td></tr>
<tr class="separator:a3dbcc886156cfc4f185cf64e9d43615d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94d9147b42c887164f3c3a21ab9c0c0b" id="r_a94d9147b42c887164f3c3a21ab9c0c0b"><td class="memItemLeft" align="right" valign="top"><a id="a94d9147b42c887164f3c3a21ab9c0c0b" name="a94d9147b42c887164f3c3a21ab9c0c0b"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>Enc</b> (const std::string &amp;in, const std::array&lt; uint64_t, 4 &gt; &amp;k, const uint64_t Nr, uint64_t nonce)</td></tr>
<tr class="separator:a94d9147b42c887164f3c3a21ab9c0c0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88e45ea3280e56ca586a8fbe6bbd1d88" id="r_a88e45ea3280e56ca586a8fbe6bbd1d88"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a88e45ea3280e56ca586a8fbe6bbd1d88">Dec</a> (const std::string &amp;in, const std::array&lt; uint64_t, 4 &gt; &amp;k, const uint64_t Nr, uint64_t nonce)</td></tr>
<tr class="memdesc:a88e45ea3280e56ca586a8fbe6bbd1d88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt a message with AES-GCM.  <br /></td></tr>
<tr class="separator:a88e45ea3280e56ca586a8fbe6bbd1d88"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions related to AES-GCM. </p>
<dl class="section remark"><dt>Remarks</dt><dd>These functions have been created in reference to: <a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf">https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf</a> Herein referred to as "The Reference" (The AES reference is not Used here). </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a88e45ea3280e56ca586a8fbe6bbd1d88" name="a88e45ea3280e56ca586a8fbe6bbd1d88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88e45ea3280e56ca586a8fbe6bbd1d88">&#9670;&#160;</a></span>Dec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string aes::gcm::Dec </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::array&lt; uint64_t, 4 &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t</td>          <td class="paramname"><span class="paramname"><em>Nr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>nonce</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt a message with AES-GCM. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>The ciphertext. </td></tr>
    <tr><td class="paramname">k</td><td>The key. </td></tr>
    <tr><td class="paramname">Nr</td><td>The number of rounds to perform. </td></tr>
    <tr><td class="paramname">nonce</td><td>The nonce value/IV. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The plaintext message. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>if the message has been modified or an incorrect key was supplied. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3dbcc886156cfc4f185cf64e9d43615d" name="a3dbcc886156cfc4f185cf64e9d43615d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dbcc886156cfc4f185cf64e9d43615d">&#9670;&#160;</a></span>GCTR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classaes_1_1state.html">state</a> aes::gcm::GCTR </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classaes_1_1state.html">state</a></td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classaes_1_1state__array.html">state_array</a></td>          <td class="paramname"><span class="paramname"><em>ICB</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply AES-CTR to a message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The state to operate on. </td></tr>
    <tr><td class="paramname">ICB</td><td>The initial vector, or nonce. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The encrypted/decrypted state. </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>See 6.5 of the Reference, and Figure 2. </dd>
<dd>
As the name suggests, this is pretty much identical to AES-CTR, Specifically the Ctr function in This file. The only difference is that our nonce is a <a class="el" href="classaes_1_1state__array.html" title="The state array is a 4x4 byte matrix to which AES operations are performed; also called a block.">state_array</a>, instead of a number (Which isn't specific To GCM or CTR, but is just how we implemented it in this case), we increment by a special function, rather than just adding one, and we return the state, rather than the unravelled string, so that we can compute the GHASH. </dd></dl>

</div>
</div>
<a id="aef9e152fad1ad6c97e90db2364ad5886" name="aef9e152fad1ad6c97e90db2364ad5886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef9e152fad1ad6c97e90db2364ad5886">&#9670;&#160;</a></span>GHASH()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classaes_1_1state__array.html">state_array</a> aes::gcm::GHASH </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classaes_1_1state.html">state</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classaes_1_1state__array.html">state_array</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>H</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the GHASH for a state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">X</td><td>The state </td></tr>
    <tr><td class="paramname">H</td><td>The hash subkey. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The hash block. </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>See 6.4 of the Reference. </dd>
<dd>
This function operates almost identically to a MAC, like HMAC-SHA256 (Hence the name). Basically we set an initial generation of Y, and then Update that value for every block in the state. We do this with a fast XOR, And then apply our multiplication on the hash subkey. Since the hash subkey Is derived from the key and nonce, this is essentially the key in an HMAC, And the state is the data that runs through the hashing algorithm. By The end of the iteration, we have a block that has been influenced by not only the key, but every block in the state, hence arriving at a hash that, if the key or any block has been modified, will not match. Since it's also a <a class="el" href="classaes_1_1state__array.html" title="The state array is a 4x4 byte matrix to which AES operations are performed; also called a block.">state_array</a> itself, We can trivially append it to the end of the state, and unravel the entire thing Without needing to send an explicit HMAC value across. </dd></dl>

</div>
</div>
<a id="ad32f2adca6691ec845600d8fa98c5bc3" name="ad32f2adca6691ec845600d8fa98c5bc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad32f2adca6691ec845600d8fa98c5bc3">&#9670;&#160;</a></span>increment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aes::gcm::increment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classaes_1_1state__array.html">state_array</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>X</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The Nonce Increment Function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">the</td><td>state array used as the counter. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>GCM uses a "more sophisticated" means of stepping the Counter that is passed to AES with the Key to generate the Pad. </dd>
<dd>
See 6.2 of the Reference. </dd>
<dd>
I couldn't find a reason for why the increment is performed This way. By only incrementing the first four bytes, it technically limits the size of the message to 4294967296 blocks, and we then repeat A nonce, which would be disaterous. That value is equal to 64GB. My best Guess is that a more performant implementation (One that wouldn't need to deconstruct the last four bytes into a new number), would be able to just cast The last bits, treat it like the very fast uint32_t directly, and increment it with instructions that are blazingly fast with this datatype (int defaults to 32bit specifically because it's fast, even faster than the native register size of 64bit. You can see this by using uint_fast32_t, which C++ mandates as an integer at least 32 bits, but can be faster if performance will improve (See <a href="https://en.cppreference.com/w/cpp/types/integer">https://en.cppreference.com/w/cpp/types/integer</a>). Yet, on every computer I've personally used, it will always be a 32 bit value, not a 64 bit, which is neat). </dd></dl>

</div>
</div>
<a id="ab95f2c83cf8f0c6a3a9bb4565d561a30" name="ab95f2c83cf8f0c6a3a9bb4565d561a30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab95f2c83cf8f0c6a3a9bb4565d561a30">&#9670;&#160;</a></span>mult()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classaes_1_1state__array.html">state_array</a> aes::gcm::mult </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classaes_1_1state__array.html">state_array</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classaes_1_1state__array.html">state_array</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>Y</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a multiplication on two blocks of data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">X</td><td>The first block. </td></tr>
    <tr><td class="paramname">Y</td><td>The second block. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: The resultant block. </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>See 6.3 of the Reference. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
