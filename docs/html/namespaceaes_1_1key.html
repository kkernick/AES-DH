<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AES-DH Implementation: aes::key Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AES-DH Implementation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceaes.html">aes</a></li><li class="navelem"><a class="el" href="namespaceaes_1_1key.html">key</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">aes::key Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Manage the key.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6897098eedfdaf07c0f7b00047d053ab" id="r_a6897098eedfdaf07c0f7b00047d053ab"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6897098eedfdaf07c0f7b00047d053ab">RotWord</a> (const uint32_t &amp;word)</td></tr>
<tr class="memdesc:a6897098eedfdaf07c0f7b00047d053ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a word by one byte left.  <br /></td></tr>
<tr class="separator:a6897098eedfdaf07c0f7b00047d053ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa37c4a1b8399e8d6dab153bac9526f28" id="r_aa37c4a1b8399e8d6dab153bac9526f28"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa37c4a1b8399e8d6dab153bac9526f28">SubWord</a> (const uint32_t &amp;word)</td></tr>
<tr class="memdesc:aa37c4a1b8399e8d6dab153bac9526f28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Substitue the bytes in a key-schedule word.  <br /></td></tr>
<tr class="separator:aa37c4a1b8399e8d6dab153bac9526f28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad91c7cb9402fbe2fa12cb7ca048dd58a" id="r_ad91c7cb9402fbe2fa12cb7ca048dd58a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; uint32_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad91c7cb9402fbe2fa12cb7ca048dd58a">Expansion</a> (const std::array&lt; uint64_t, 4 &gt; &amp;key, const uint64_t &amp;Nk)</td></tr>
<tr class="memdesc:ad91c7cb9402fbe2fa12cb7ca048dd58a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expand a set of keys.  <br /></td></tr>
<tr class="separator:ad91c7cb9402fbe2fa12cb7ca048dd58a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a48c4a1c357aa64e2ff50d205301ef6fd" id="r_a48c4a1c357aa64e2ff50d205301ef6fd"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48c4a1c357aa64e2ff50d205301ef6fd">Rcon</a> [10]</td></tr>
<tr class="memdesc:a48c4a1c357aa64e2ff50d205301ef6fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">The round constants.  <br /></td></tr>
<tr class="separator:a48c4a1c357aa64e2ff50d205301ef6fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manage the key. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad91c7cb9402fbe2fa12cb7ca048dd58a" name="ad91c7cb9402fbe2fa12cb7ca048dd58a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad91c7cb9402fbe2fa12cb7ca048dd58a">&#9670;&#160;</a></span>Expansion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; uint32_t &gt; aes::key::Expansion </td>
          <td>(</td>
          <td class="paramtype">const std::array&lt; uint64_t, 4 &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t &amp;</td>          <td class="paramname"><span class="paramname"><em>Nk</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Expand a set of keys. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The shared key array. </td></tr>
    <tr><td class="paramname">Nk</td><td>The size of the key in words. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector of the keys to use. </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is a verbatim translation of Algorithm 2 of the Reference. </dd>
<dd>
key is always exchanged as 4 64bit numbers, or 256 bits total. Nk simply determines where the cutoff is made, thus removing the last 64 bits for AES-192, or the last 128 for AES-128. </dd>
<dd>
When implementing this algorithm, there are two real options: Either do it like the Reference, where we treat the key schedule as a collection of words Or treat it like a collection of individual bytes. The former will be faster, but will also require bitwise operation to index positions in each word. The latter, on the other hand Makes more sense when working on a per key level, but can be confusing when looking at the whole schedule. We followed the Reference. </dd>
<dd>
In essence this function takes a "small" key, and expands it to be large enough for all of AES' rounds, such that it looks random. See Section 5.8 of the 2002 Paper for more details. </dd>
<dd>
For a more visual explanation, see Figure 6, 7, and 8 of the Reference. </dd></dl>

</div>
</div>
<a id="a6897098eedfdaf07c0f7b00047d053ab" name="a6897098eedfdaf07c0f7b00047d053ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6897098eedfdaf07c0f7b00047d053ab">&#9670;&#160;</a></span>RotWord()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t aes::key::RotWord </td>
          <td>(</td>
          <td class="paramtype">const uint32_t &amp;</td>          <td class="paramname"><span class="paramname"><em>word</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a word by one byte left. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">word</td><td>The word. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The rotated word. </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>See Figure 5.10 of the Reference </dd></dl>

</div>
</div>
<a id="aa37c4a1b8399e8d6dab153bac9526f28" name="aa37c4a1b8399e8d6dab153bac9526f28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa37c4a1b8399e8d6dab153bac9526f28">&#9670;&#160;</a></span>SubWord()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t aes::key::SubWord </td>
          <td>(</td>
          <td class="paramtype">const uint32_t &amp;</td>          <td class="paramname"><span class="paramname"><em>word</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Substitue the bytes in a key-schedule word. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">word</td><td>The word </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The modified word. </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This uses the exact same algorithm as SubBytes, and as with that step, the Reference just uses a lookup table rather than manually computig it. </dd>
<dd>
See Figure 5.11 of the Reference. </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a48c4a1c357aa64e2ff50d205301ef6fd" name="a48c4a1c357aa64e2ff50d205301ef6fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48c4a1c357aa64e2ff50d205301ef6fd">&#9670;&#160;</a></span>Rcon</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t aes::key::Rcon[10]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">      0x01000000, 0x02000000, 0x04000000, 0x08000000, 0x10000000,</div>
<div class="line">      0x20000000, 0x40000000, 0x80000000, 0x1b000000, 0x36000000</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p>The round constants. </p>
<dl class="section remark"><dt>Remarks</dt><dd>This is copied from Table 5 of the Reference. </dd>
<dd>
The Reference likes to split up words into the individual bytes, but we just treat the whole word as one number. </dd>
<dd>
These values can be computed via r(i)= x(iâˆ’4)/4 mod(x8+x4+x3+x+1) </dd>
<dd>
Why do we use these round constants? It eliminates symmetries. See: The 2002 Paper for more details. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
