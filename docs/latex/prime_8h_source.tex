\doxysection{prime.\+h}
\hypertarget{prime_8h_source}{}\label{prime_8h_source}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <cmath>}\ \ \ \ \textcolor{comment}{//\ For\ std::sqrt()}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <cstdlib>}\ \ \textcolor{comment}{//\ For\ randomness.}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <cstdint>}\ \ \textcolor{comment}{//\ For\ fixed\ width\ integers.}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceprime}{prime}}\ \{}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00021\ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespaceprime_a46236c1d23c9711231e97132407d33af}{is}}(\textcolor{keyword}{const}\ uint64\_t\&\ num)\ \{}
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\ ==\ 1)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{comment}{//\ We\ only\ need\ to\ check\ up\ to\ the\ square\ root\ of\ the\ number\ in\ order\ to\ know\ if\ it's\ prime.}}
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{keyword}{auto}\ root\ =\ \textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}(std::sqrt(num))\ +\ 1;}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{comment}{//\ Start\ at\ 2,\ so\ we\ don't\ get\ a\ 0/1\ false\ positive.}}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ x\ =\ 2;\ x\ <=\ root;\ ++x)\ \{}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (num\ \%\ x\ ==\ 0)}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00031\ \ \ \ \ \}}
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00033\ \ \ \}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00044\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T\ =\ u\textcolor{keywordtype}{int}64\_t>\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceprime_a7c8557a10c21117dd64b2ad1f88370de}{next}}(T\&\ num)\ \{}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{comment}{//\ Get\ to\ an\ odd\ number.}}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\ \%\ 2\ ==\ 0)\ num++;}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{comment}{//\ Loop\ until\ we\ find\ one.}}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ !\mbox{\hyperlink{namespaceprime_a46236c1d23c9711231e97132407d33af}{prime::is}}(num);\ num\ +=\ 2)\ \{\}}
\DoxyCodeLine{00050\ \ \ \}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00064\ \ \ \textcolor{keyword}{inline}\ uint64\_t\ \mbox{\hyperlink{namespaceprime_afd42038a213dacfa2cf643b7fd78a180}{raise}}(uint64\_t\ value,\ uint64\_t\ exp,\ \textcolor{keyword}{const}\ uint64\_t\&\ mod)\ \{}
\DoxyCodeLine{00065\ \ \ \ \ uint64\_t\ ret\ =\ 1;}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{comment}{//\ Ensure\ it's\ bounded\ by\ the\ mod.}}
\DoxyCodeLine{00068\ \ \ \ \ value\ =\ value\ \%\ mod;}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{comment}{//\ March\ down\ the\ exponent\ until\ it's\ been\ 0d.}}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keywordflow}{while}\ (exp\ >\ 0)\ \{}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ current\ bit\ is\ 1,\ multiply\ ret\ by\ our\ value,\ and\ mod\ it.}}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (exp\ \&\ 1)\ ret\ =\ (ret*value)\ \%\ mod;}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \ \ \ \ \textcolor{comment}{//\ Shift\ exp\ down.}}
\DoxyCodeLine{00077\ \ \ \ \ \ \ exp\ =\ exp\ >>\ 1;}
\DoxyCodeLine{00078\ \ \ \ \ \ \ value\ =\ (value*value)\ \%\ mod;}
\DoxyCodeLine{00079\ \ \ \ \ \}}
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{00081\ \ \ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00093\ \ \ \textcolor{keyword}{inline}\ std::pair<uint64\_t,\ uint64\_t>\ \mbox{\hyperlink{namespaceprime_a55b24169031fb8a19e7f1bc724a63fda}{generate}}()\ \{}
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keyword}{auto}\ q\ =\ \textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(std::rand());}
\DoxyCodeLine{00095\ \ \ \ \ \mbox{\hyperlink{namespaceprime_a7c8557a10c21117dd64b2ad1f88370de}{prime::next<uint32\_t>}}(q);}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{comment}{//\ Sometime's\ q\ will\ not\ be\ prime,\ due\ to\ casting.}}
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{comment}{//\ We\ can\ just\ re-\/roll\ the\ number\ if\ that's\ the\ case.}}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keyword}{auto}\ p\ =\ (\textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}(q)\ *\ 2)\ +\ 1;}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespaceprime_a46236c1d23c9711231e97132407d33af}{prime::is}}(p))\ \{}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceprime_a55b24169031fb8a19e7f1bc724a63fda}{prime::generate}}();}
\DoxyCodeLine{00102\ \ \ \ \ \}}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordflow}{return}\ \{p,\ q\};}
\DoxyCodeLine{00104\ \ \ \}}
\DoxyCodeLine{00105\ \}}

\end{DoxyCode}
